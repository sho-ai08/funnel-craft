# マーケティング導線3D可視化アプリ 要件定義書

## 1. プロジェクト概要

### 1.1 目的
マーケティングにおける集客からキャッシュポイントまでの導線を、ニューラルネットワーク的な3Dグラフ構造で可視化するWebアプリケーション。

### 1.2 コンセプト
- 各コンテンツ（SNS投稿、記事、広告、商品ページ等）を「ニューロン（ノード）」として表現
- コンテンツ間のリンク構造を「シナプス（エッジ）」として可視化
- 集客→フロントエンド→バックエンドの流れを直感的に把握可能

### 1.3 利用環境
- **プラットフォーム**: Webブラウザ（PC専用）
- **推奨ブラウザ**: Chrome, Firefox, Edge（最新版）

---

## 2. 機能要件

### 2.1 ノード（ニューロン）管理

#### 2.1.1 ノードの種類
| カテゴリ | 種類 | 説明 | 色（例） |
|---------|------|------|----------|
| **集客** | SNS投稿 | X, Instagram等の各投稿 | 青系 |
| **集客** | 記事 | ブログ記事、コラム等 | 緑系 |
| **集客** | 広告 | リスティング広告、SNS広告等 | 黄系 |
| **キャッシュポイント** | フロントエンド | 低単価商品・入口商品 | オレンジ系 |
| **キャッシュポイント** | バックエンド | 高単価商品・本命商品 | 赤系 |

#### 2.1.2 ノードが持つ情報
| 項目 | 必須/任意 | 説明 |
|------|----------|------|
| タイトル | 必須 | ノードの名前（例：「X投稿_20240115」） |
| URL | 任意 | 実際のコンテンツへのリンク |
| カテゴリ | 必須 | 集客 or キャッシュポイント |
| 種類 | 必須 | SNS投稿/記事/広告/フロントエンド/バックエンド |
| 説明文 | 任意 | 役割やメモ |
| 数値データ | 任意 | 自由に項目追加可能（後述） |

#### 2.1.3 数値データ（カスタムフィールド）
ユーザーが自由に追加・削除できる数値項目：
- 例：PV数、クリック数、CVR（%）、売上金額、顧客単価 等
- **形式**: 項目名（テキスト）+ 値（数値）のペア
- **上限**: 1ノードあたり最大10項目程度

#### 2.1.4 ノード操作
- **追加**: 「+」ボタンからノード新規作成
- **編集**: ノードをダブルクリックで編集パネル表示
- **削除**: 編集パネル内の削除ボタン、または選択してDeleteキー
- **移動**: ドラッグ&ドロップで3D空間内を自由移動

---

### 2.2 リンク（エッジ）管理

#### 2.2.1 リンクの特性
- **方向性**: 一方向（A → B）のみ
- **表示**: 矢印付きの線で表現
- **意味**: 「AからBへ誘導する」という導線の流れ

#### 2.2.2 リンク作成方法

**方法A：ドラッグ&ドロップ**
1. ノードAの端からドラッグ開始
2. ノードBにドロップ
3. リンク作成完了

**方法B：クリック選択**
1. ノードAを選択
2. 「リンク追加」ボタンをクリック
3. ノードBをクリック
4. リンク作成完了

#### 2.2.3 リンク操作
- **削除**: リンクをクリックして選択 → Deleteキー または 削除ボタン

---

### 2.3 3Dビュー操作

#### 2.3.1 カメラ操作
| 操作 | アクション |
|------|----------|
| 視点回転 | マウス左ドラッグ |
| ズームイン/アウト | マウススクロール |
| 平行移動（パン） | マウス右ドラッグ |

#### 2.3.2 操作範囲
- **回転**: 360度全方向
- **ズーム**: 制限なし（極端なズームは除く）

#### 2.3.3 補助機能
- **リセットビュー**: カメラ位置を初期状態に戻すボタン
- **オートフィット**: 全ノードが画面内に収まるよう自動調整

---

### 2.4 レイアウト機能

#### 2.4.1 手動配置
- ノードをドラッグして任意の位置に配置
- 3D空間内のX, Y, Z軸方向に移動可能

#### 2.4.2 自動レイアウト
- **ボタン1クリック**で自動整列
- アルゴリズム: 階層型レイアウト（集客→キャッシュポイントの流れを左から右へ）
- 自動レイアウト後も手動調整可能

---

### 2.5 保存・読み込み機能

#### 2.5.1 保存
- **形式**: JSONファイル（.json）
- **内容**: ノード情報、リンク情報、位置情報すべて
- **方法**: 「保存」ボタン → ファイルダウンロード

#### 2.5.2 読み込み
- **方法**: 「読み込み」ボタン → ファイル選択
- **動作**: 現在の状態を破棄し、ファイルの内容を復元

#### 2.5.3 ブラウザ保存
- ブラウザを閉じた場合はデータ消失（仕様）
- 作業中は定期的な手動保存を推奨

---

### 2.6 エクスポート機能

#### 2.6.1 PDF出力
- 現在の3Dビューを2D画像としてPDF化
- ノード一覧表（テキスト情報）も含める

#### 2.6.2 画像出力
- **形式**: PNG
- **内容**: 現在の3Dビューのスクリーンショット

---

## 3. 画面構成

### 3.1 メイン画面レイアウト

```
┌─────────────────────────────────────────────────────────┐
│  ヘッダー（タイトル、保存/読込/エクスポートボタン）      │
├───────────┬─────────────────────────────────────────────┤
│           │                                             │
│  サイド   │                                             │
│  パネル   │           3Dビューエリア                     │
│           │                                             │
│  ・ノード │                                             │
│   追加    │                                             │
│  ・一覧   │                                             │
│  ・検索   │                                             │
│           │                                             │
├───────────┴─────────────────────────────────────────────┤
│  ステータスバー（ノード数、リンク数、操作ヒント）        │
└─────────────────────────────────────────────────────────┘
```

### 3.2 各パネルの機能

#### ヘッダー
- アプリタイトル
- 保存ボタン（JSON出力）
- 読み込みボタン（JSON入力）
- エクスポートボタン（PDF/PNG選択）

#### サイドパネル
- ノード追加ボタン（+）
- ノード一覧（カテゴリ別折りたたみ表示）
- 検索フィルター
- 自動レイアウトボタン
- リセットビューボタン

#### 編集パネル（ノード選択時にポップアップ）
- タイトル入力
- URL入力
- カテゴリ選択
- 種類選択
- 説明文入力
- 数値データ追加/編集/削除
- ノード削除ボタン

---

## 4. データ構造

### 4.1 ノードデータ

```json
{
  "id": "node_001",
  "title": "X投稿：新商品告知",
  "url": "https://x.com/xxxxx/status/123456",
  "category": "traffic",  // traffic | cashpoint
  "type": "sns",          // sns | article | ad | frontend | backend
  "description": "新商品発売の告知投稿",
  "metrics": [
    { "name": "インプレッション", "value": 15000 },
    { "name": "クリック数", "value": 320 },
    { "name": "CTR", "value": 2.1 }
  ],
  "position": { "x": 0, "y": 0, "z": 0 }
}
```

### 4.2 リンクデータ

```json
{
  "id": "link_001",
  "source": "node_001",  // 始点ノードID
  "target": "node_002"   // 終点ノードID
}
```

### 4.3 プロジェクトファイル全体

```json
{
  "version": "1.0",
  "exportedAt": "2024-01-15T10:30:00Z",
  "nodes": [ ... ],
  "links": [ ... ]
}
```

---

## 5. 非機能要件

### 5.1 パフォーマンス
- ノード数100個程度でスムーズに動作
- 60fps以上の描画を目標

### 5.2 ユーザビリティ
- 直感的な操作（ドラッグ&ドロップ中心）
- ツールチップでの操作ガイド
- キーボードショートカット対応

### 5.3 データ保全
- 保存操作は明示的に実行（自動保存なし）
- 読み込み前に確認ダイアログ表示

---

## 6. 技術スタック（提案）

### 6.1 フロントエンド
- **フレームワーク**: React
- **3Dライブラリ**: Three.js + React Three Fiber
- **UIライブラリ**: Tailwind CSS
- **状態管理**: Zustand または React Context

### 6.2 3Dグラフ描画
- **選択肢A**: Three.js + カスタム実装
- **選択肢B**: 3d-force-graph ライブラリ（推奨）
  - 物理シミュレーションベースの自動配置
  - ノード・リンクの3D描画が容易

### 6.3 ファイル操作
- **JSON保存/読込**: ブラウザ標準API
- **PDF出力**: jsPDF + html2canvas
- **PNG出力**: Three.jsのレンダラーから直接出力

---

## 7. 将来の拡張案（スコープ外）

以下は今回の実装には含めないが、将来的に検討可能：

- [ ] 複数プロジェクト管理
- [ ] クラウド保存（ユーザー認証付き）
- [ ] 共有機能（URLでの共有）
- [ ] コンバージョン率の自動計算・表示
- [ ] アニメーション（データフローの流れを可視化）
- [ ] スマートフォン対応
- [ ] コラボレーション機能（複数人同時編集）

---

## 8. 用語定義

| 用語 | 定義 |
|------|------|
| ノード | 各コンテンツを表す点（ニューロン） |
| リンク | ノード間の導線を表す線（エッジ） |
| 集客 | ユーザーを集めるためのコンテンツ |
| キャッシュポイント | 収益が発生するポイント |
| フロントエンド | 入口となる低単価商品 |
| バックエンド | 本命の高単価商品 |

---

## 9. 承認

| 項目 | 日付 | 承認者 |
|------|------|--------|
| 要件定義書作成 | - | - |
| 要件定義書承認 | - | - |

---

*本要件定義書は、開発着手前に内容を確認・承認いただくことを推奨します。*